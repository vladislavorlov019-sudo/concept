# A3) Карта знаний: Потоки данных и архитектура решений

## 1. Обзор информационного ландшафта
Представленная карта знаний визуализирует сквозной процесс (End-to-End) преобразования данных в компании. Архитектура построена на принципах **ELT (Extract, Load, Transform)**, что позволяет отделить процесс извлечения данных от их сложной аналитической обработки, перенеся нагрузку с учетных систем на специализированное хранилище.

Схема движения данных разделена на 5 логических уровней (Layers):

---

## 2. Детальное описание потоков

### Слой 1: Источники данных (Data Sources)
Входной контур системы характеризуется высокой фрагментацией ("информационные колодцы"). Данные поступают из трех разнородных сред:
* **Транзакционные системы (1С, CRM):** Источники "твердых" фактов (проводки, отгрузки, статусы сделок). Доступ к ним осуществляется через API.
* **Файловая система (Excel):** Источник плановых показателей и бюджетов, которые исторически ведутся вручную.
* **Проблема уровня:** Отсутствие единых справочников и разный формат данных (JSON, XML, xlsx).

### Слой 2: Оркестрация и Контроль качества (Processing Layer)
Это "фильтр" системы. Здесь происходит первичная обработка потоков оркестратором (n8n / Power Automate).
* **Data Sanitizer (Санитизация):** Очистка данных от технического шума, приведение дат и валют к стандарту ISO.
* **Data Quality Check (Контроль качества):** Ключевой модуль безопасности. Перед загрузкой данные проходят автоматические тесты:
    * *Проверка целостности:* Есть ли обязательные поля (ID клиента, дата)?
    * *Проверка логики:* Не отрицательная ли цена? Не дублируется ли заказ?
    * *Результат:* Некорректные данные отбрасываются, администратор получает уведомление. В хранилище попадает только "чистая" информация.

### Слой 3: Аналитическое хранилище (DWH)
Ядро системы на базе колоночной СУБД **ClickHouse**. Архитектура данных внутри DWH разделена на два уровня:
1.  **Raw Layer (Сырой слой):** Сюда данные пишутся "как есть" после очистки. Обеспечивает историчность и возможность пересчета.
2.  **Production Layer (Витрины данных):** Здесь формируются "плоские", широкие таблицы (Data Marts), агрегированные специально под бизнес-задачи (Витрина продаж, Витрина складских остатков). Именно к этому слою обращается BI-система.

### Слой 4: Бизнес-аналитика (BI)
Слой визуализации на базе **Yandex DataLens**.
* Система не хранит данные, а генерирует SQL-запросы к ClickHouse в режиме реального времени.
* **Безопасность (RLS):** Реализован механизм Row Level Security. Система фильтрует данные на уровне строк в зависимости от логина пользователя. Один и тот же дашборд показывает разные цифры Директору и Менеджеру.

### Слой 5: Потребители (Stakeholders)
Конечные пользователи получают не просто таблицы, а инструменты принятия решений:
* **Ген. Директор:** Видит стратегическую картину (P&L, выполнение годового плана).
* **РОП (Руководитель отдела продаж):** Получает оперативный мониторинг (воронка продаж, дебиторская задолженность), освобождаясь от ручного сведения отчетов.
* **Менеджеры:** Видят свои личные показатели и прогноз премии.

---

## 3. Резюме
Данная архитектура превращает хаотичные потоки данных в структурированный актив. Ключевым преимуществом является внедрение **автоматического контроля качества** на раннем этапе (Слой 2), что исключает риск принятия управленческих решений на основе ошибочных данных.
