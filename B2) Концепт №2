# B2) Концепт №2: Архитектурно-функциональное решение и Оценка эффективности

## 1. Введение: Методологический подход
Настоящий документ описывает целевое состояние (Target State) системы автоматизированной отчетности. 
Проектирование выполнено с соблюдением принципов платформы **«ГосТех»** и современных стандартов системного анализа:
* **Клиентоцентричность:** Проектирование от потребностей пользователя ("От жизненной ситуации").
* **Доменная архитектура:** Разделение данных на независимые функциональные области.
* **Технологический суверенитет:** Использование импортонезависимого стека технологий.

---

## 2. Проблематика, цели, ограничения и клиентские пути

### 2.1. Проблематика (AS-IS)
Анализ текущих бизнес-процессов выявил ряд критических ограничений, препятствующих масштабированию производственной компании:
1.  **Ресурсный дисбаланс:** Высококвалифицированный Руководитель отдела продаж (РОП) тратит до **20% рабочего времени** на ручную консолидацию данных (функция ETL-инженера), вместо стратегического управления продажами.
2.  **Информационная фрагментация:** Данные о продажах, складе и финансах изолированы в разрозненных системах (1С, CRM, Excel), не имеющих единых справочников (Master Data).
3.  **Высокая задержка (Latency):** Время подготовки сводного отчета составляет от 4 до 8 часов (Batch-режим). Это делает невозможным оперативное реагирование на внутридневные изменения спроса.

### 2.2. Цели проекта (SMART)
* **Сокращение трудозатрат:** Снизить время на подготовку отчетности с 8 часов/неделю до **0 часов** (полная автоматизация).
* **Качество данных:** Обеспечить 100% валидацию входящих потоков; исключить попадание в отчеты дублей и ошибок ручного ввода.
* **Скорость:** Обеспечить доступность аналитики в режиме **Near Real-Time** (обновление данных каждые 15-30 минут).

### 2.3. Ограничения и допущения
* **Импортозамещение:** Запрет на использование облачных сервисов, не локализованных в РФ или подверженных санкционным рискам (AWS, Power BI).
* **Бюджет:** Ориентация на Open-Source решения и ПО с низкой стоимостью владения (TCO).
* **Безопасность (RBAC):** Данные о маржинальности и ФОТ должны быть скрыты от линейного персонала.

### 2.4. Клиентские пути (CJM)
Система проектируется "от человека". Выделены ключевые сценарии использования:

* **Сценарий А: "Стратегический монитор" (Ген. директор)**
    * *Триггер:* Начало рабочей недели.
    * *Действие:* Просмотр дашборда на мобильном устройстве.
    * *Потребность:* Оценить P&L, кассовый разрыв и динамику Year-to-Year за 1 минуту.
    * *Результат:* Решение о корректировке бюджета или производства.

* **Сценарий Б: "Оперативный контроль" (РОП)**
    * *Триггер:* Ежедневная планерка в 09:00.
    * *Действие:* Анализ воронки продаж и дебиторской задолженности.
    * *Потребность:* Выявить "красные зоны" (отстающих менеджеров, зависшие сделки) без выгрузки отчетов.
    * *Результат:* Постановка точечных задач команде на основе фактов.

---

## 3. Общее описание архитектуры

Архитектурное решение декомпозировано на три логических уровня в соответствии со стандартом ГОСТ Р 59853-2021.

### 3.1. Функциональная архитектура (Business Capability)
Описывает, *какие бизнес-функции* выполняет система:
1.  **Модуль "Сбор и Нормализация":** Подключение к источникам (1C, CRM), парсинг файлов планов и унификация справочников (MDM).
2.  **Модуль "Контроль качества" (Data Quality):** Автоматический аудит данных на полноту, типы и бизнес-логику (например, *Цена > 0*).
3.  **Модуль "Хранение и Витрины":** Историческое хранение сырых логов и расчет быстрых агрегатов для аналитики.
4.  **Модуль "Визуализация":** Предоставление интерактивного графического интерфейса с ролевой моделью доступа.

### 3.2. Программная архитектура (Application Architecture)
Описывает, *на каком ПО* реализована система. Стек полностью соответствует требованиям импортозамещения:
* **Оркестрация:** `n8n` — Low-code платформа для управления потоками данных.
* **СУБД:** `ClickHouse` — российская колоночная база данных, оптимизированная для аналитических нагрузок (OLAP).
* **BI-платформа:** `Yandex DataLens` — облачный сервис визуализации (входит в реестр отечественного ПО).
* **Среда исполнения:** `Docker` — контейнеризация для независимости от инфраструктуры.

### 3.3. Архитектура данных (Data Architecture)
Описывает, *как преобразуются данные*. Реализована многослойная модель (Medallion Architecture):

1.  **Слой Bronze (Raw Data):** Хранилище исходных JSON/CSV. Обеспечивает полный аудиторский след и возможность пересчета.
2.  **Слой Silver (Core Data):** Нормализованное хранилище по схеме **"Звезда"** (Таблицы фактов + Таблицы измерений). Гарантирует целостность ссылок.
3.  **Слой Gold (Data Marts):** Денормализованные "плоские" витрины. Данные заранее соединены (JOIN) для мгновенной отдачи в BI. Реализует принцип **"Data as a Product"**.

---

## 4. Оценка экономической эффективности

Внедрение системы рассматривается как инвестиционный проект. Оценка произведена через расчет возврата инвестиций (ROI) и совокупной стоимости владения (TCO).

### 4.1. Качественный эффект
1.  **Прозрачность (Data-Driven):** Переход от интуитивного управления к управлению на основе верифицированных метрик.
2.  **Дисциплина и Мотивация:** Автоматический, прозрачный для всех расчет KPI снимает социальное напряжение в коллективе и повышает доверие к руководству.
3.  **Минимизация рисков:** Устранение "человеческого фактора" предотвращает ошибки в расчете складских остатков и заморозку оборотных средств.

### 4.2. Количественный эффект (Расчет)
Расчет произведен на основе модели ФОТ для роли Руководителя отдела продаж.

* **Базовые параметры:**
    * Совокупные затраты на РОПа (ЗП + налоги + рабочее место): ~250 000 руб./мес.
    * Потери времени на ручную отчетность (AS-IS): **20%** (8 часов в неделю).
* **Прямые убытки (AS-IS):**
    $$250\,000 \times 0.20 = 50\,000 \text{ руб./мес.}$$
    *(Стоимость использования дорогого ресурса для неквалифицированной работы)*.

* **Затраты на систему (TO-BE):**
    * Лицензии ПО: 0 руб. (Open Source / Free Tier).
    * Аренда сервера (Cloud VPS): ~3 000 руб./мес.
    * **Итого TCO:** 3 000 руб./мес.

### 4.3. Итоговый результат
Экономия операционных расходов (OPEX) составляет:
$$Экономия = 50\,000 - 3\,000 = 47\,000 \text{ руб./мес.}$$

**Вывод:** Проект окупает трудозатраты на разработку и внедрение в течение **2-3 месяцев**. Система высвобождает критически важный управленческий ресурс, который перенаправляется на генерацию выручки (работу с ключевыми клиентами).
